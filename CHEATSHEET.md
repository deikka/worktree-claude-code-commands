# Git Worktrees Cheatsheet

**Version 1.1.0** - Quick reference for worktree commands with Claude Code.

---

## üöÄ Quick Start

```bash
# Install commands
./install.sh

# Create worktree (smart mode - RECOMMENDED)
/worktree-start rails "Add JWT authentication with refresh tokens"

# Compare before merge
/worktree-compare main

# Merge and cleanup
/worktree-merge main
```

---

## üìù Slash Commands (Claude Code)

| Command | Description | Example |
|---------|-------------|---------|
| `/worktree-start <stack> "description"` | Create worktree (smart) | `/worktree-start rails "Add JWT auth"` |
| `/worktree-start <stack> name` | Create worktree (manual) | `/worktree-start node user-auth` |
| `/worktree-start -v <stack> "desc"` | Create worktree (verbose) | `/worktree-start -v py "Add feature"` |
| `/worktree-compare [branch]` | Compare changes | `/worktree-compare main` |
| `/worktree-merge [branch]` | Merge and cleanup | `/worktree-merge main` |
| `/worktree-list` | List worktrees | `/worktree-list` |
| `/worktree-list cleanup` | Clean merged | `/worktree-list cleanup` |
| `/worktree-list prune` | Clean stale | `/worktree-list prune` |

**üí° Pro Tips:**
- Use smart mode (with description) - Claude generates the name automatically
- Use `-v` flag for verbose output when debugging
- Stack aliases: `wp`‚Üíwordpress, `js`/`ts`‚Üínode, `py`‚Üípython

**Supported Stacks:** `rails`, `wordpress`/`wp`, `node`/`js`/`ts`, `python`/`py`, `go`, `rust`, `generic`

---

## üîÑ Basic Workflow

```bash
# 1Ô∏è‚É£ CREATE - Smart mode with detailed description
/worktree-start rails "Add two-factor authentication with SMS and email support"

# 2Ô∏è‚É£ WORK - Navigate and code
cd ../feat/two-factor-auth-sms-email
# ... code, commits ...

# 3Ô∏è‚É£ COMPARE - Review before merge
/worktree-compare main

# 4Ô∏è‚É£ TEST - Validate it works
bin/rails test              # Rails
vendor/bin/phpunit          # WordPress

# 5Ô∏è‚É£ MERGE - Integrate and clean
/worktree-merge main
```

---

## üéØ Essential Git Commands

### Within Worktree

```bash
# View status
git status

# Commit changes
git add .
git commit -m "[feat] Description"

# Push to remote
git push origin branch-name

# View diff of current changes
git diff

# View commit log
git log --oneline

# Temporary stash (if needed)
git stash
git stash pop
```

### From Main Repository

```bash
# View all worktrees
git worktree list

# Remove specific worktree
git worktree remove /path/to/worktree

# Clean stale references
git worktree prune

# View merged branches
git branch --merged main
```

---

## üìä Comparison: Smart vs Manual Mode

| Aspect | Smart Mode | Manual Mode |
|---------|-----------|-------------|
| **Command** | `/worktree-start rails "Add JWT auth"` | `/worktree-start rails jwt-auth` |
| **Branch name** | Auto-generated by Claude | Use what you specify |
| **FEATURE.md** | ‚úÖ Created with context | ‚ùå Not created |
| **Suggestions** | ‚úÖ Files to review | ‚ùå No suggestions |
| **Checklist** | ‚úÖ TODO generated | ‚ùå No checklist |
| **Speed** | Slower (~5s) | Faster (~1s) |
| **Recommended use** | Complex features | Quick fixes |

**üí° Rule:** If the project takes >1 hour, use smart mode.

---

## ‚ö° Shortcuts and Tips

### Quick Navigation

```bash
# Useful aliases (add to .bashrc/.zshrc)
alias wl='/worktree-list'
alias ws='/worktree-start'
alias wc='/worktree-compare'
alias wm='/worktree-merge'

# Quick navigation
cd ..     # Go up to parent directory
cd -      # Return to previous directory
```

### Multiple Terminals/IDEs

```bash
# Terminal 1: Main work
cd /path/to/project

# Terminal 2: Feature A
cd /path/to/project
/worktree-start rails "Feature A"
cd ../feat/feature-a

# Terminal 3: Feature B
cd /path/to/project
/worktree-start rails "Feature B"
cd ../feat/feature-b

# Each terminal works independently
```

### Quick Weekly Cleanup

```bash
# Every Friday
/worktree-list cleanup && /worktree-list prune
```

---

## üîç Quick Troubleshooting

| Error | Cause | Quick Solution |
|-------|-------|-----------------|
| "Branch already exists" | Worktree already exists | `/worktree-list` ‚Üí verify |
| "Uncommitted changes" | Changes without commit | `git add . && git commit -m "msg"` |
| "Not in a worktree" | Command in main repo | `cd ../feature-branch` |
| "Merge conflict" | Files in conflict | Resolve manually |
| Worktree won't delete | Directory in use | Close IDE/terminal |

---

## üìê Naming Conventions

### Rails Projects

| Prefix | Use | Example |
|--------|-----|---------|
| `feat/` | New feature | `feat/jwt-authentication` |
| `fix/` | Bug fix | `fix/login-validation` |
| `refactor/` | Refactoring | `refactor/user-model` |
| `test/` | Tests | `test/auth-integration` |
| `chore/` | Maintenance | `chore/update-deps` |

### WordPress Projects

| Prefix | Use | Example |
|--------|-----|---------|
| `feature/` | New feature | `feature/custom-widget` |
| `bugfix/` | Bug fix | `bugfix/payment-flow` |
| `enhancement/` | Enhancement | `enhancement/admin-ui` |
| `hotfix/` | Critical fix | `hotfix/security-patch` |

---

## üìã Pre-Merge Checklist

Before doing `/worktree-merge`, verify:

### Rails
- [ ] `bin/rails test` ‚Üí ‚úÖ Pass
- [ ] `bundle exec rubocop` ‚Üí ‚úÖ No offenses
- [ ] No `binding.pry` or `debugger` in code
- [ ] Migrations included and reversible
- [ ] Schema.rb updated
- [ ] Routes OK
- [ ] No hardcoded credentials

### WordPress
- [ ] `npm run build` ‚Üí ‚úÖ Compiled
- [ ] No `var_dump()` or `dd()` in code
- [ ] Assets compiled in `public/`
- [ ] Composer dependencies OK
- [ ] Plugin/theme version bumped (if applicable)
- [ ] No API keys in code

---

## üéì Common Workflows

### Workflow 1: Normal Feature

```bash
/worktree-start rails "Add feature X"
cd ../feat/feature-x
# ... work ...
git add . && git commit -m "[feat] Add X"
/worktree-compare main
/worktree-merge main
```

### Workflow 2: Urgent Hotfix

```bash
# While working on feature
/worktree-start rails "Hotfix: Critical bug"
cd ../hotfix/critical-bug
# ... fix ...
git add . && git commit -m "[fix] Critical bug"
/worktree-merge main
# Return to feature without interruptions
```

### Workflow 3: Experimentation

```bash
/worktree-start rails "Experiment with X"
cd ../feat/experiment-x
# ... try things ...
# Doesn't work? No problem
cd ..
rm -rf feat/experiment-x
/worktree-list prune
```

### Workflow 4: Code Review

```bash
/worktree-start rails colleague-branch
cd ../colleague-branch
# ... review code, run tests ...
# No merge, just review
cd ..
rm -rf colleague-branch
/worktree-list prune
```

---

## üíæ Useful Git Commands

### View Changes

```bash
# Diff of working directory
git diff

# Diff staged
git diff --staged

# Diff with another branch
git diff main..HEAD

# View specific file
git diff main -- path/to/file

# Change stats
git diff --stat main..HEAD
```

### Logs and History

```bash
# Compact log
git log --oneline -10

# Log with graph
git log --oneline --graph --all

# Commits not in main
git log main..HEAD --oneline

# View specific commit
git show <commit-hash>
```

### Branches

```bash
# List branches
git branch

# View merged
git branch --merged main

# View unmerged
git branch --no-merged main

# Delete local branch
git branch -d branch-name
git branch -D branch-name  # force

# Delete remote branch
git push origin --delete branch-name
```

---

## üîß Recommended Configuration

### Global Git Config

```bash
# Better log alias
git config --global alias.lg "log --oneline --graph --all --decorate"

# Better status alias
git config --global alias.st "status -sb"

# Better diff alias
git config --global alias.df "diff --color --stat"

# Auto-prune on fetch
git config --global fetch.prune true

# Default push behavior
git config --global push.default current
```

### Install Delta (Better Diffs)

```bash
# macOS
brew install git-delta

# Linux
cargo install git-delta

# Auto-used by /worktree-compare
```

---

## üìö Commands by Frequency of Use

### Daily (80%)

```bash
/worktree-start rails "Feature description"
cd ../feature-branch
git add . && git commit -m "msg"
/worktree-compare main
/worktree-merge main
```

### Weekly (15%)

```bash
/worktree-list cleanup
/worktree-list prune
/worktree-list  # View state
```

### Occasional (5%)

```bash
git worktree remove /path/to/worktree
git branch -D branch-name
git push origin --delete branch-name
```

---

## üö´ Anti-Patterns (Avoid These)

### ‚ùå DON'T do

```bash
# Create worktree without meaningful description
/worktree-start rails "test"
/worktree-start rails "changes"
/worktree-start rails "wip"

# Merge without comparing first
/worktree-merge main  # Without /worktree-compare before

# Have 10+ worktrees open
# CONFUSING!

# Navigate between worktrees in same terminal
cd ../worktree1
cd ../worktree2  # Confusion guaranteed

# Do rm -rf without git worktree remove
rm -rf ../feature-branch
# Leaves orphaned references
```

### ‚úÖ DO

```bash
# Specific description in smart mode
/worktree-start rails "Add OAuth2 with Google and GitHub providers"

# Always compare before merge
/worktree-compare main
/worktree-merge main

# Maximum 2-3 active worktrees
# Manageable

# Use separate terminal/IDE per worktree
# Each in its space

# Use proper commands for cleanup
/worktree-merge main  # Auto-cleanup
```

---

## üéØ KPIs of Good Usage

**Indicators you're using it well:**

- ‚úÖ Features merged in <3 days
- ‚úÖ `/worktree-list` shows <4 worktrees
- ‚úÖ Always use `/worktree-compare` before merge
- ‚úÖ Tests pass before each merge
- ‚úÖ Weekly cleanup keeps workspace clean

**Warning signs:**

- ‚ö†Ô∏è 10+ worktrees open
- ‚ö†Ô∏è Branches with 2+ weeks without merge
- ‚ö†Ô∏è Many "WIP" commits
- ‚ö†Ô∏è Never use `/worktree-compare`
- ‚ö†Ô∏è Always have merge conflicts

---

## üìñ Quick References

### Complete Documentation

- [`START_HERE.md`](./START_HERE.md) - Step-by-step tutorial
- [`README.md`](./README.md) - Complete guide
- [`worktree-start.md`](./worktree-start.md) - Creation details
- [`worktree-compare.md`](./worktree-compare.md) - Comparison details
- [`worktree-merge.md`](./worktree-merge.md) - Merge details
- [`worktree-list.md`](./worktree-list.md) - Management and cleanup

### Useful Links

- [Git Worktree Docs](https://git-scm.com/docs/git-worktree)
- [Claude Code Docs](https://docs.claude.com/en/docs/claude-code)
- [Git Best Practices](https://git-scm.com/book/en/v2)

---

## üéì To Memorize

**The 3 commands you'll use 90% of the time:**

```bash
1. /worktree-start rails "Feature description"
2. /worktree-compare main
3. /worktree-merge main
```

**Golden rule:**

> Always compare before merging.
> Short features (<3 days).
> Regular cleanup.

---

**Print this and stick it on your monitor. üìå**

**Need more details?** ‚Üí [`START_HERE.md`](./START_HERE.md)
